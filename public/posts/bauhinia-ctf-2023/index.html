<!DOCTYPE html>
<html lang="en" style="font-size: 100%">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=40099&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <meta name="author" content="Michael Neuper">

  
  
  <meta name="description" content="Tuần vừa rồi, mình có chơi giải Bauhinia CTF với team @phis1Ng_. Mình thấy các challenge Crypto được đánh giá cao, với lại nhạc cũng hay nữa :))), mình có làm được một vài challenge về Crypto nên muốn chia sẻ với mọi người
grhkm&rsquo;s babyRSA
chall.py
from math import gcd
from Crypto.Util.number import getPrime, getRandomNBitInteger, bytes_to_long
from secret import flag

lcm = lambda u, v: u*v//gcd(u, v)

bits = 1024
given = bits // 5
e_bits = bits // 12

mask = (1 &lt;&lt; given) - 1

while True:
    p = getPrime(bits // 2)
    q = getPrime(bits // 2)
    N = p * q

    if N.bit_length() != bits:
        continue

    l = lcm(p - 1, q - 1)
    e = getRandomNBitInteger(e_bits)

    if gcd(e, l) &gt; 1:
        continue

    d = pow(e, -1, l)

    dp = int(d % (p - 1))
    dq = int(d % (q - 1))

    break

l_dp = dp &amp; mask
l_dq = dq &amp; mask

print(f&#39;{N = }&#39;)
print(f&#39;{e = }&#39;)
print(f&#39;{l_dp = }&#39;)
print(f&#39;{l_dq = }&#39;)

flag = bytes_to_long(flag)

ct = pow(flag, e, N)
print(f&#39;{ct = }&#39;)
">
  

  
  <link rel="apple-touch-icon" sizes="180x180" href="http://localhost:40099//images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="http://localhost:40099//images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="http://localhost:40099//images/favicon-16x16.png">

  
  
  <meta name="keywords" content='hugo latex theme blog texify texify2 texify3 michael neuper'>
  

  
  
  <link rel="stylesheet" href='/katex/katex.min.css'>
<script defer defer src='/katex/katex.min.js'></script>
<script defer src='/katex/contrib/auto-render.min.js'></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          throwOnError : false
        });
    });
</script>
  

  
  <script data-name="BMC-Widget" 
    data-cfasync="true" 
    src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" 
    data-id="michaelneuper" 
    data-description="Like what I do? Buy me a coffee!" 
    data-message="" 
    data-color="#d79921" 
    data-position="Right" 
    data-x_margin="18" 
    data-y_margin="18"
    crossorigin="anonymous">
</script>


  
  <meta property="og:url" content="http://localhost:40099/posts/bauhinia-ctf-2023/">
  <meta property="og:site_name" content="Giap&#39;s Blog">
  <meta property="og:title" content="Bauhinia CTF 2023">
  <meta property="og:description" content="Tuần vừa rồi, mình có chơi giải Bauhinia CTF với team @phis1Ng_. Mình thấy các challenge Crypto được đánh giá cao, với lại nhạc cũng hay nữa :))), mình có làm được một vài challenge về Crypto nên muốn chia sẻ với mọi người
grhkm’s babyRSA chall.py
from math import gcd from Crypto.Util.number import getPrime, getRandomNBitInteger, bytes_to_long from secret import flag lcm = lambda u, v: u*v//gcd(u, v) bits = 1024 given = bits // 5 e_bits = bits // 12 mask = (1 &lt;&lt; given) - 1 while True: p = getPrime(bits // 2) q = getPrime(bits // 2) N = p * q if N.bit_length() != bits: continue l = lcm(p - 1, q - 1) e = getRandomNBitInteger(e_bits) if gcd(e, l) &gt; 1: continue d = pow(e, -1, l) dp = int(d % (p - 1)) dq = int(d % (q - 1)) break l_dp = dp &amp; mask l_dq = dq &amp; mask print(f&#39;{N = }&#39;) print(f&#39;{e = }&#39;) print(f&#39;{l_dp = }&#39;) print(f&#39;{l_dq = }&#39;) flag = bytes_to_long(flag) ct = pow(flag, e, N) print(f&#39;{ct = }&#39;) ">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-08-22T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-01-15T22:09:54+07:00">
    <meta property="article:tag" content="CTF-Writeup">


  
  <link rel="canonical" href="http://localhost:40099/posts/bauhinia-ctf-2023/">

  
  
  
  <meta itemprop="name" content="Bauhinia CTF 2023">
  <meta itemprop="description" content="Tuần vừa rồi, mình có chơi giải Bauhinia CTF với team @phis1Ng_. Mình thấy các challenge Crypto được đánh giá cao, với lại nhạc cũng hay nữa :))), mình có làm được một vài challenge về Crypto nên muốn chia sẻ với mọi người
grhkm’s babyRSA chall.py
from math import gcd from Crypto.Util.number import getPrime, getRandomNBitInteger, bytes_to_long from secret import flag lcm = lambda u, v: u*v//gcd(u, v) bits = 1024 given = bits // 5 e_bits = bits // 12 mask = (1 &lt;&lt; given) - 1 while True: p = getPrime(bits // 2) q = getPrime(bits // 2) N = p * q if N.bit_length() != bits: continue l = lcm(p - 1, q - 1) e = getRandomNBitInteger(e_bits) if gcd(e, l) &gt; 1: continue d = pow(e, -1, l) dp = int(d % (p - 1)) dq = int(d % (q - 1)) break l_dp = dp &amp; mask l_dq = dq &amp; mask print(f&#39;{N = }&#39;) print(f&#39;{e = }&#39;) print(f&#39;{l_dp = }&#39;) print(f&#39;{l_dq = }&#39;) flag = bytes_to_long(flag) ct = pow(flag, e, N) print(f&#39;{ct = }&#39;) ">
  <meta itemprop="datePublished" content="2023-08-22T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-01-15T22:09:54+07:00">
  <meta itemprop="wordCount" content="2336">
  <meta itemprop="keywords" content="CTF-Writeup">

  
  
  
    <link rel="stylesheet" href="/css/common.min.e562d763c6d0825495eb17de8b2c1d9800cf7c08db1c36accedf77a5fccfc4b9.css" integrity="sha256-5WLXY8bQglSV6xfeiywdmADPfAjbHDaszt93pfzPxLk=" crossorigin="anonymous">
  

  
  
    <link rel="stylesheet" href="/css/content.min.ba38eba94cb47fef9936258c42d11ff19fa9686a30b38e783773fe3f15eb44dc.css" integrity="sha256-ujjrqUy0f&#43;&#43;ZNiWMQtEf8Z&#43;paGows454N3P&#43;PxXrRNw=" crossorigin="anonymous">
  

  
  
  <title>Bauhinia CTF 2023 - Giap&#39;s Blog</title>
  

  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Bauhinia CTF 2023">
  <meta name="twitter:description" content="Tuần vừa rồi, mình có chơi giải Bauhinia CTF với team @phis1Ng_. Mình thấy các challenge Crypto được đánh giá cao, với lại nhạc cũng hay nữa :))), mình có làm được một vài challenge về Crypto nên muốn chia sẻ với mọi người
grhkm’s babyRSA chall.py
from math import gcd from Crypto.Util.number import getPrime, getRandomNBitInteger, bytes_to_long from secret import flag lcm = lambda u, v: u*v//gcd(u, v) bits = 1024 given = bits // 5 e_bits = bits // 12 mask = (1 &lt;&lt; given) - 1 while True: p = getPrime(bits // 2) q = getPrime(bits // 2) N = p * q if N.bit_length() != bits: continue l = lcm(p - 1, q - 1) e = getRandomNBitInteger(e_bits) if gcd(e, l) &gt; 1: continue d = pow(e, -1, l) dp = int(d % (p - 1)) dq = int(d % (q - 1)) break l_dp = dp &amp; mask l_dq = dq &amp; mask print(f&#39;{N = }&#39;) print(f&#39;{e = }&#39;) print(f&#39;{l_dp = }&#39;) print(f&#39;{l_dq = }&#39;) flag = bytes_to_long(flag) ct = pow(flag, e, N) print(f&#39;{ct = }&#39;) ">


  


  <link rel="stylesheet" href="/css/single.min.be779f459ad7e3aaf8afd0f80c6a61ca6c50993f5f18512532100ac6d93f0fa9.css" integrity="sha256-vnefRZrX46r4r9D4DGphymxQmT9fGFElMhAKxtk/D6k=" crossorigin="anonymous">


  <link rel="stylesheet" href="/css/single.min.78a121b7d7a160420f9daab0ea13add66c37b9c44f27bba07b27207e2b0975d2.css" integrity="sha256-eKEht9ehYEIPnaqw6hOt1mw3ucRPJ7ugeycgfisJddI=" crossorigin="anonymous">


</head>

<body>
  <div id="wrapper">
    


<header id="header">
  <h1>
    <a href="http://localhost:40099/">Giap&#39;s Blog</a>
    <button id="dark-mode-toggle" class="dark-mode-toggle" aria-label="Toggle theme">
        <svg width="2rem" height="2rem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 496">
        <path fill="currentColor" d="M8,256C8,393,119,504,256,504S504,393,504,256,393,8,256,8,8,119,8,256ZM256,440V72a184,184,0,0,1,0,368Z" transform="translate(-8 -8)"/>
        </svg>
    </button>
  </h1>

  <nav>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17,11H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm0,4H16a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2ZM11,9h6a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2ZM21,3H7A1,1,0,0,0,6,4V7H3A1,1,0,0,0,2,8V18a3,3,0,0,0,3,3H18a4,4,0,0,0,4-4V4A1,1,0,0,0,21,3ZM6,18a1,1,0,0,1-2,0V9H6Zm14-1a2,2,0,0,1-2,2H7.82A3,3,0,0,0,8,18V5H20Zm-9-4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Zm0,4h1a1,1,0,0,0,0-2H11a1,1,0,0,0,0,2Z"/></svg>
</span>
      
      <a class="link" href="/posts/">Blog</a>
    </span>
    
    <span class="nav-bar-item">
      
        <span class="icon"><svg width="1em" height="1em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1">
<path d="M10.07031,20.50291a1.00008,1.00008,0,0,0-1.18115-.9834c-1.30908.24024-2.96191.27637-3.40137-.958a5.70754,5.70754,0,0,0-1.83691-2.415,1.20073,1.20073,0,0,1-.1665-.10938,1,1,0,0,0-.93067-.64551H2.54883a.99965.99965,0,0,0-1,.99512c-.00391.81543.811,1.33789,1.1416,1.51465a4.4408,4.4408,0,0,1,.92383,1.35937c.36426,1.02344,1.42285,2.57617,4.46582,2.376.001.03516.00195.06836.00244.09863l.00439.26758a1,1,0,0,0,2,0l-.00488-.31836C10.07715,21.4951,10.07031,21.22068,10.07031,20.50291Zm10.667-15.126c.03174-.125.063-.26367.09034-.41992a6.27792,6.27792,0,0,0-.40821-3.293,1.002,1.002,0,0,0-.61572-.58007c-.356-.12012-1.67041-.35645-4.18408,1.25a13.86918,13.86918,0,0,0-6.354,0C6.76221.751,5.45459.9658,5.10205,1.07908a.99744.99744,0,0,0-.63135.584,6.3003,6.3003,0,0,0-.40332,3.35644c.02442.12793.05078.2461.07813.35449A6.26928,6.26928,0,0,0,2.89014,9.20311a8.42168,8.42168,0,0,0,.04248.92187c.334,4.60254,3.334,5.98438,5.42431,6.459-.04345.125-.083.25878-.11816.40039a1.00023,1.00023,0,0,0,1.94238.47851,1.6784,1.6784,0,0,1,.46778-.87793.99947.99947,0,0,0-.5459-1.74512c-3.4541-.39453-4.95362-1.80175-5.1792-4.89843a6.61076,6.61076,0,0,1-.03369-.73828,4.25769,4.25769,0,0,1,.91943-2.71289,3.022,3.022,0,0,1,.1958-.23145.99988.99988,0,0,0,.188-1.02441,3.3876,3.3876,0,0,1-.15527-.55567A4.09356,4.09356,0,0,1,6.1167,3.06346a7.54263,7.54263,0,0,1,2.415,1.17968,1.00877,1.00877,0,0,0,.82764.13282,11.77716,11.77716,0,0,1,6.17285.001,1.00549,1.00549,0,0,0,.83056-.13769,7.572,7.572,0,0,1,2.40528-1.19043,4.03977,4.03977,0,0,1,.0874,1.57812,3.205,3.205,0,0,1-.16895.60743.9999.9999,0,0,0,.188,1.02441c.07715.08691.1543.18066.22363.26855A4.12186,4.12186,0,0,1,20,9.20311a7.03888,7.03888,0,0,1-.0376.77734c-.22021,3.05566-1.72558,4.46387-5.1958,4.85937a1,1,0,0,0-.54541,1.7461,1.63079,1.63079,0,0,1,.46631.9082,3.06079,3.06079,0,0,1,.09229.81934v2.334C14.77,21.2949,14.77,21.78025,14.77,22.00291a1,1,0,1,0,2,0c0-.2168,0-.69238.00977-1.33984V18.31346a4.8815,4.8815,0,0,0-.15479-1.31153,4.25638,4.25638,0,0,0-.11621-.416,6.51258,6.51258,0,0,0,5.44531-6.42383A8.69677,8.69677,0,0,0,22,9.20311,6.13062,6.13062,0,0,0,20.7373,5.37693Z"/></svg>
</span>
      
      <a class="link" href="https://github.com/Giapppp">GitHub</a>
    </span>
    
  </nav>
</header>
<hr class="head-rule"></hr>
    
<main id="main" class="post">
  
  <div class="post-heading">
    <h1 class="post-title">Bauhinia CTF 2023</h1>
    <div class="publish-metadata">
      
      <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 9H21M7 3V5M17 3V5M6 13H8M6 17H8M11 13H13M11 17H13M16 13H18M16 17H18M6.2 21H17.8C18.9201 21 19.4802 21 19.908 20.782C20.2843 20.5903 20.5903 20.2843 20.782 19.908C21 19.4802 21 18.9201 21 17.8V8.2C21 7.07989 21 6.51984 20.782 6.09202C20.5903 5.71569 20.2843 5.40973 19.908 5.21799C19.4802 5 18.9201 5 17.8 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V17.8C3 18.9201 3 19.4802 3.21799 19.908C3.40973 20.2843 3.71569 20.5903 4.09202 20.782C4.51984 21 5.07989 21 6.2 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      22 August 2023
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.4998 5.49994L18.3282 8.32837M3 20.9997L3.04745 20.6675C3.21536 19.4922 3.29932 18.9045 3.49029 18.3558C3.65975 17.8689 3.89124 17.4059 4.17906 16.9783C4.50341 16.4963 4.92319 16.0765 5.76274 15.237L17.4107 3.58896C18.1918 2.80791 19.4581 2.80791 20.2392 3.58896C21.0202 4.37001 21.0202 5.63634 20.2392 6.41739L8.37744 18.2791C7.61579 19.0408 7.23497 19.4216 6.8012 19.7244C6.41618 19.9932 6.00093 20.2159 5.56398 20.3879C5.07171 20.5817 4.54375 20.6882 3.48793 20.9012L3 20.9997Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          2336 words
        </span>
      
      
      
        
      
      
        &nbsp;
        <span>
          <svg width="0.75em" height="0.75em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 7V12L14.5 13.5M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          ~11 mins
        </span>
      
    </div>
  </div>

  
  <div>
    
    <a class="link tag" href='http://localhost:40099/tags/ctf-writeup'>#CTF-Writeup</a>
    
    <br></br>
  </div>
  
  
  
  <details>
    <summary>
      <b>Table of Contents</b>
    </summary>
    <div class="toc numbered-subtitles"><nav id="TableOfContents">
  <ul>
    <li><a href="#grhkms-babyrsa">grhkm&rsquo;s babyRSA</a></li>
    <li><a href="#-how-to-stop-time">* How to stop time</a></li>
  </ul>
</nav></div>
  </details>
  
  
  <article class="content numbered-subtitles">
    
    <p>Tuần vừa rồi, mình có chơi giải Bauhinia CTF với team @phis1Ng_. Mình thấy các challenge Crypto được đánh giá cao, với lại nhạc cũng hay nữa :))), mình có làm được một <del>vài</del> challenge về Crypto nên muốn chia sẻ với mọi người</p>
<h2 id="grhkms-babyrsa">grhkm&rsquo;s babyRSA</h2>
<p><code>chall.py</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">gcd</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">getPrime</span><span class="p">,</span> <span class="n">getRandomNBitInteger</span><span class="p">,</span> <span class="n">bytes_to_long</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">secret</span> <span class="kn">import</span> <span class="n">flag</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">lcm</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="o">//</span><span class="n">gcd</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bits</span> <span class="o">=</span> <span class="mi">1024</span>
</span></span><span class="line"><span class="cl"><span class="n">given</span> <span class="o">=</span> <span class="n">bits</span> <span class="o">//</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="n">e_bits</span> <span class="o">=</span> <span class="n">bits</span> <span class="o">//</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">given</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="n">bits</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="n">bits</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">N</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">!=</span> <span class="n">bits</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="n">lcm</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span> <span class="o">=</span> <span class="n">getRandomNBitInteger</span><span class="p">(</span><span class="n">e_bits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">gcd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">dp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span> <span class="o">%</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">dq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span> <span class="o">%</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">l_dp</span> <span class="o">=</span> <span class="n">dp</span> <span class="o">&amp;</span> <span class="n">mask</span>
</span></span><span class="line"><span class="cl"><span class="n">l_dq</span> <span class="o">=</span> <span class="n">dq</span> <span class="o">&amp;</span> <span class="n">mask</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">N</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">e</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">l_dp</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">l_dq</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ct</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ct</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p><code>output.txt</code></p>
<pre tabindex="0"><code>N = 96446191626393604009054111437713980755082681332020571709789032122186639773874753631630024642568257679734714430483780317122960230235124140242511126339536047435591010087751700582288534654352742251068909342986464462021206713195415006300821397979265537607226612724482984235104418995222711966835565604156795231519
e = 21859725745573183363159471
l_dp = 5170537512721293911585823686902506016823042591640808668431139
l_dq = 2408746727412251844978232811750068549680507130361329347219033
ct = 22853109242583772933543238072263595310890230858387007784810842667331395014960179858797539466440641309211418058958036988227478000761691182791858340813236991362094115499207490244816520864518250964829219489326391061014660200164748055767774506872271950966288147838511905213624426774660425957155313284952800718636
</code></pre><p>Đây là một bài liên quan về RSA-CRT, challenge cho ta LSB của <code>dp</code> và <code>dq</code> và mục tiêu của ta sẽ là phân tích <code>n</code>. Nếu như các bạn không hiểu mục đích của <code>dp</code> và <code>dq</code> là gì thì có thể đọc qua về <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Using_the_Chinese_remainder_algorithm">RSA-CRT</a></p>
<p>Bằng một chút osint, mình đã tìm ra một paper liên quan đến bài này: <a href="https://eprint.iacr.org/2022/271.pdf">Factoring with Only a Third of the Secret CRT-Exponents</a>. Mình sẽ giải thích chi tiết hơn về paper này</p>
<p>Ta có các equation sau: $$\begin{align} dp &amp;= h_{dp} * 2^{given} + l_{dp} \newline dq &amp;= h_{dq} * 2^{given} + l_{dp} \end{align} \newline e * dp = k * (p - 1) + 1 \newline e * dq = l * (q - 1) + 1$$</p>
<p>Với $k, l, h_{dp}, h_{dq}$ là các ẩn mà ta chưa biết</p>
<p>Đọc phần 3.2, ta có thể xây dựng được một đa thức 2 biến có nghiệm $(k, l)$ là:</p>
<p>$$\begin{aligned}
A &amp;= e * (l_{dp} + l_{dq}) - e^2 * l_{dp} * l_{dq} - 1
\end{aligned}$$</p>
<p>và</p>
<p>$$f(x, y) = (N-1)xy - (el_{dq}-1)x - (el_{dp}-1)y + A$$</p>
<p>Với chú ý rằng 2 giá trị $k, l &lt; e$, ta sẽ tìm nghiệm của đa thức này bằng Coppersmith. Các bạn có thể kiếm python script của Coppersmith ở trên mạng khá nhiều. Ở đây, mình sử dụng code của <a href="https://github.com/defund/coppersmith/blob/master/coppersmith.sage">Defund</a></p>
<p><code>find_k_l.sage</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">itertools</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">bits</span> <span class="o">=</span> <span class="mi">1024</span>
</span></span><span class="line"><span class="cl"><span class="n">given</span> <span class="o">=</span> <span class="n">bits</span> <span class="o">//</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="n">e_bits</span> <span class="o">=</span> <span class="n">bits</span> <span class="o">//</span> <span class="mi">12</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">given</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">l_dp</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">l_dq</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">ct</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="n">l_dp</span> <span class="o">+</span> <span class="n">l_dq</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l_dp</span> <span class="o">*</span> <span class="n">l_dq</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">PR</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="n">given</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">l_dq</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">l_dp</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">A</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">small_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="ow">not</span> <span class="n">d</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">d</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">R</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">N</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="c1">#f /= f.coefficients().pop(0)</span>
</span></span><span class="line"><span class="cl">	<span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">G</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([],</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">base</span> <span class="o">=</span> <span class="n">N</span><span class="o">^</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span><span class="o">^</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">		<span class="k">for</span> <span class="n">shifts</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">nvariables</span><span class="p">()):</span>
</span></span><span class="line"><span class="cl">			<span class="n">g</span> <span class="o">=</span> <span class="n">base</span> <span class="o">*</span> <span class="n">prod</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">variables</span><span class="p">(),</span> <span class="n">shifts</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">			<span class="n">G</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">B</span><span class="p">,</span> <span class="n">monomials</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">coefficient_matrix</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">	<span class="n">monomials</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">monomials</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">factors</span> <span class="o">=</span> <span class="p">[</span><span class="n">monomial</span><span class="p">(</span><span class="o">*</span><span class="n">bounds</span><span class="p">)</span> <span class="k">for</span> <span class="n">monomial</span> <span class="ow">in</span> <span class="n">monomials</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">factor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">factors</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">B</span><span class="o">.</span><span class="n">rescale_col</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">dense_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">factor</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">factors</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">B</span><span class="o">.</span><span class="n">rescale_col</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">factor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="n">H</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">([],</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">B</span><span class="o">*</span><span class="n">monomials</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">		<span class="n">H</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="n">I</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">ideal</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">H</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="k">elif</span> <span class="n">I</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">roots</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span> <span class="n">root</span> <span class="ow">in</span> <span class="n">I</span><span class="o">.</span><span class="n">variety</span><span class="p">(</span><span class="n">ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">				<span class="n">root</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">root</span><span class="p">[</span><span class="n">var</span><span class="p">])</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">variables</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">				<span class="n">roots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">roots</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">k</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">small_roots</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">e</span><span class="p">),</span> <span class="n">m</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
</span></span></code></pre></div><p>Ta sẽ tìm được $(k, l) = (12177905682444242771542873, 4277124735150641724212759)$</p>
<p>Theo phần 3.3 của paper, sau khi đã có $k, l$, ta có thể xây dựng một đa thức $g$ trên $Z_N$ có nghiệm là $h_{dp}$:
$$\begin{align} a &amp;= (el_{dp} + k - 1) * (2^{-i}e \mod k*N) \newline g(x) &amp;= x + a \end{align}$$</p>
<p>Ta tiếp tục dùng Coppersmith để tìm nghiệm của $g$, tuy nhiên, không hiểu sao script ở trên không tìm được nghiệm của $g$</p>
<p>Vì thế nên mình đã đọc kĩ hơn paper, và tìm được <a href="https://github.com/juliannowakowski/crtrsa-small-e-pke/blob/main/implementation_new_attack.sage">script</a> của tác giả cái paper này. Ở đây, tác giả có xây dựng hàm <a href="http://hyperelliptic.org/tanja/teaching/crypto20/20200922-lll.pdf">Coppersmith mở rộng</a> và nó hiệu quả nên mình đã sử dụng nó với một chút hiệu chỉnh</p>
<p><code>find_h_dp.sage</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">m_2</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1">#Parameter for 2nd Lattice</span>
</span></span><span class="line"><span class="cl"><span class="n">t_2</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1">#Parameter for 2nd Lattice</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">k</span> <span class="o">=</span> <span class="mi">12177905682444242771542873</span>
</span></span><span class="line"><span class="cl"><span class="n">l</span> <span class="o">=</span> <span class="mi">4277124735150641724212759</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="mi">512</span>
</span></span><span class="line"><span class="cl"><span class="n">dSize</span> <span class="o">=</span> <span class="mi">512</span>
</span></span><span class="line"><span class="cl"><span class="n">alpha</span> <span class="o">=</span> <span class="mi">85</span>
</span></span><span class="line"><span class="cl"><span class="n">Unknown_MSB</span> <span class="o">=</span> <span class="mi">512</span> <span class="o">-</span> <span class="n">given</span>
</span></span><span class="line"><span class="cl"><span class="n">LSB_dp</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="n">l_dp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">TWO_POWER</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">dSize</span> <span class="o">-</span> <span class="n">Unknown_MSB</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">QQ</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="p">(</span><span class="n">TWO_POWER</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">LSB_dp</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">IN_k</span> <span class="o">=</span> <span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">TWO_POWER</span><span class="p">)</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">IN_k</span><span class="o">*</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">LSB_dp</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">)</span> <span class="c1"># Make f monic by inverting the coefficient of x</span>
</span></span><span class="line"><span class="cl"><span class="n">X</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="n">Unknown_MSB</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Generate shift polynomials and store these polynomials in F. Store monomials of shift polynomials in S </span>
</span></span><span class="line"><span class="cl"><span class="n">F</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m_2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">h</span> <span class="o">=</span> <span class="n">f</span><span class="o">^</span><span class="n">i</span><span class="o">*</span><span class="n">k</span><span class="o">^</span><span class="p">(</span><span class="n">m_2</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="o">^</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t_2</span><span class="o">-</span><span class="n">i</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">Form a matrix MAT. Entries of MAT are coming from the coefficient 
</span></span></span><span class="line"><span class="cl"><span class="s2">vector from shift polynomials which are stored in F
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2nd lattice dimension&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">MAT</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">   <span class="n">f</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">   <span class="n">f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">X</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="n">coeffs</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">coefficients</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coeffs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">       <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">coeffs</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">   <span class="n">MAT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeffs</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">process_time</span>
</span></span><span class="line"><span class="cl"><span class="n">TIME_Start</span> <span class="o">=</span> <span class="n">process_time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">tt</span> <span class="o">=</span> <span class="n">cputime</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">MAT</span> <span class="o">=</span> <span class="n">MAT</span><span class="o">.</span><span class="n">LLL</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">TIME_Stop</span> <span class="o">=</span> <span class="n">process_time</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2nd LLL time&#39;</span><span class="p">,</span> <span class="n">TIME_Stop</span><span class="o">-</span><span class="n">TIME_Start</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Get all polynomial </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">A</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">  <span class="n">f</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">cij</span> <span class="o">=</span> <span class="n">MAT</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">cij</span> <span class="o">=</span> <span class="n">cij</span><span class="o">/</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">X</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cj</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">cij</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="o">=</span> <span class="n">f</span> <span class="o">+</span> <span class="n">cj</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>    
</span></span><span class="line"><span class="cl">  <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">A</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">roots</span><span class="p">())</span>
</span></span></code></pre></div><p>Ở đây, mình sẽ kiểm tra xem nghiệm $c$ của đa thức nào trong $A$ là $h_{dp}$ bằng cách tính $gcd(g(c), N) = d$. Nếu $d &gt; 1$ thì đó chính là $p$ mà ta cần tìm</p>
<p>Ta tìm được</p>
<p>$h_{dp} = 180951980763775058492815911873237082514145707000972099423553967985124001563643605807070492022$</p>
<p>Từ đó tìm được</p>
<p>$p = 8351309129105229708154695602362829027250608775685390771007529034429910339403472223935574054850623494610995086524639065024717100915125468017775773884252621$</p>
<p>Khi đã có $p$, mọi chuyện là đơn giản:</p>
<p><code>solve.py</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">ct</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">N</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="n">N</span> <span class="o">//</span> <span class="n">p</span>
</span></span><span class="line"><span class="cl"><span class="n">e</span> <span class="o">=</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">long_to_bytes</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>
</span></span></code></pre></div><blockquote>
<p>flag: b6actf{y0u_mu5t_b3_c0nv1nc3d_th4t_lgn/5_is_gr34t3r_th4n_lgn/4_n0w}</p>
</blockquote>
<h2 id="-how-to-stop-time">* How to stop time</h2>
<p><code>chall.py</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Since the script is simple, I will just add a lot of useless information to</span>
</span></span><span class="line"><span class="cl"><span class="c1"># distract you all. Good luck identifying whether one is a red herring!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Although I am using the &#34;os&#34; package, I don&#39;t call &#34;os.system&#34;. Now give up on</span>
</span></span><span class="line"><span class="cl"><span class="c1"># that wacky thoughts.</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I am using the `random` package, which is known to be using MT19937, a</span>
</span></span><span class="line"><span class="cl"><span class="c1"># reversable pseudorandom number generator. Maybe you can make use of them?</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># I sometime receive complaints from players regarding installing random Python</span>
</span></span><span class="line"><span class="cl"><span class="c1"># packages all around. I will refrain from using third-party packages for this</span>
</span></span><span class="line"><span class="cl"><span class="c1"># challenge. Hope that helps!</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">mathy</span> <span class="kn">import</span> <span class="n">is_prime</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Please do not submit &#34;flag{this_is_a_fake_flag}&#34; as the flag! This is only</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># a placeholder and this is not the REAL flag for the challenge. Go nc to</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># the actual server for the actual flag!</span>
</span></span><span class="line"><span class="cl">    <span class="n">flag</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FLAG&#39;</span><span class="p">,</span> <span class="s1">&#39;flag</span><span class="si">{this_is_a_fake_flag}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># &#34;Once is happenstance. Twice is coincidence...</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#  Sixteen times is a recovery of the pseudorandom number generator.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#                                       - &#34;Maybe Someday&#34; on Google CTF 2022</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># But... How about 256 times? Prediction of pseudorandom number generator?</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># I will pregenerate those values ahead. Can you read that before</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># sending q?</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">getrandbits</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Yeah, come send me a large-enough prime q!</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;[&lt;] q = &#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># Told you I need a large-enough prime.</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">q</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">==</span> <span class="mi">512</span> <span class="ow">and</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># I was going to set &#34;p = 2*q + 1&#34; to make p a safe prime... I will just</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># changing that to &#34;p = 4*q + 1&#34; to pretend that there is a bug. Let&#39;s</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># call that a... pseudo-safe prime?</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">q</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[&gt;] </span><span class="si">{</span><span class="n">g</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># I intentionally computes g^x mod p between printing g and h. Good luck</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># unleashing a timing attack!</span>
</span></span><span class="line"><span class="cl">        <span class="n">h</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[&gt;] </span><span class="si">{</span><span class="n">h</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1"># You have to recover me the &#34;x&#34;. Quickly.</span>
</span></span><span class="line"><span class="cl">        <span class="n">_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;[&lt;] x = &#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="k">assert</span> <span class="n">x</span> <span class="o">==</span> <span class="n">_x</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># How should I innotate this? Go grab the flag!</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[*] </span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">main</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[!] Well played.&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p><code>mathy.py</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Functions copied from &#34;That-crete log&#34; from UIUCTF 2022. Thanks!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">miller_rabin</span><span class="p">(</span><span class="n">bases</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># I don&#39;t know how to annotate this because it involves of a bunch of</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># mathematics that I could not understand, but I still want to be verbose.</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Maybe I should link you the wiki page so you could read that...</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># https://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="n">s</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">//=</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">continue</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">%</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># bases = [2, 3, 5, 7, 11, 13, 17, 19, 31337] are used by the challenge from</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># UIUCTF. That isn&#39;t good enough...</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># I learned from ICPC that those seven bases blocks every number below 2^64.</span>
</span></span><span class="line"><span class="cl">    <span class="n">bases</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">325</span><span class="p">,</span> <span class="mi">9375</span><span class="p">,</span> <span class="mi">28178</span><span class="p">,</span> <span class="mi">450775</span><span class="p">,</span> <span class="mi">9780504</span><span class="p">,</span> <span class="mi">1795265022</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># I will also add a bunch of random bases. Well, I really meant it. This is</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># how I generate those bases:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#       sorted([random.randint(2, 1000000)*2+1 for _ in range(200)])</span>
</span></span><span class="line"><span class="cl">    <span class="n">bases</span> <span class="o">+=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">          <span class="mi">20669</span><span class="p">,</span>   <span class="mi">48929</span><span class="p">,</span>   <span class="mi">57021</span><span class="p">,</span>   <span class="mi">63569</span><span class="p">,</span>   <span class="mi">73307</span><span class="p">,</span>   <span class="mi">86815</span><span class="p">,</span>   <span class="mi">93495</span><span class="p">,</span>  <span class="mi">101303</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">124851</span><span class="p">,</span>  <span class="mi">126617</span><span class="p">,</span>  <span class="mi">164415</span><span class="p">,</span>  <span class="mi">171811</span><span class="p">,</span>  <span class="mi">184653</span><span class="p">,</span>  <span class="mi">219385</span><span class="p">,</span>  <span class="mi">221067</span><span class="p">,</span>  <span class="mi">223499</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">229897</span><span class="p">,</span>  <span class="mi">234477</span><span class="p">,</span>  <span class="mi">251893</span><span class="p">,</span>  <span class="mi">264151</span><span class="p">,</span>  <span class="mi">295599</span><span class="p">,</span>  <span class="mi">299453</span><span class="p">,</span>  <span class="mi">308525</span><span class="p">,</span>  <span class="mi">316135</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">318467</span><span class="p">,</span>  <span class="mi">319081</span><span class="p">,</span>  <span class="mi">326169</span><span class="p">,</span>  <span class="mi">341721</span><span class="p">,</span>  <span class="mi">343699</span><span class="p">,</span>  <span class="mi">351743</span><span class="p">,</span>  <span class="mi">374223</span><span class="p">,</span>  <span class="mi">378375</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">387703</span><span class="p">,</span>  <span class="mi">387807</span><span class="p">,</span>  <span class="mi">390443</span><span class="p">,</span>  <span class="mi">417763</span><span class="p">,</span>  <span class="mi">430031</span><span class="p">,</span>  <span class="mi">438233</span><span class="p">,</span>  <span class="mi">440079</span><span class="p">,</span>  <span class="mi">441259</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">444591</span><span class="p">,</span>  <span class="mi">465613</span><span class="p">,</span>  <span class="mi">475205</span><span class="p">,</span>  <span class="mi">485841</span><span class="p">,</span>  <span class="mi">501341</span><span class="p">,</span>  <span class="mi">509761</span><span class="p">,</span>  <span class="mi">515577</span><span class="p">,</span>  <span class="mi">528775</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">533381</span><span class="p">,</span>  <span class="mi">536401</span><span class="p">,</span>  <span class="mi">558123</span><span class="p">,</span>  <span class="mi">562419</span><span class="p">,</span>  <span class="mi">583397</span><span class="p">,</span>  <span class="mi">606965</span><span class="p">,</span>  <span class="mi">617121</span><span class="p">,</span>  <span class="mi">619821</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">625787</span><span class="p">,</span>  <span class="mi">632805</span><span class="p">,</span>  <span class="mi">650751</span><span class="p">,</span>  <span class="mi">689307</span><span class="p">,</span>  <span class="mi">695181</span><span class="p">,</span>  <span class="mi">695725</span><span class="p">,</span>  <span class="mi">704809</span><span class="p">,</span>  <span class="mi">706557</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">720371</span><span class="p">,</span>  <span class="mi">729335</span><span class="p">,</span>  <span class="mi">737269</span><span class="p">,</span>  <span class="mi">741827</span><span class="p">,</span>  <span class="mi">743969</span><span class="p">,</span>  <span class="mi">745609</span><span class="p">,</span>  <span class="mi">750425</span><span class="p">,</span>  <span class="mi">764843</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">768725</span><span class="p">,</span>  <span class="mi">782945</span><span class="p">,</span>  <span class="mi">789713</span><span class="p">,</span>  <span class="mi">794851</span><span class="p">,</span>  <span class="mi">832829</span><span class="p">,</span>  <span class="mi">849477</span><span class="p">,</span>  <span class="mi">849917</span><span class="p">,</span>  <span class="mi">872481</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">880381</span><span class="p">,</span>  <span class="mi">880601</span><span class="p">,</span>  <span class="mi">882991</span><span class="p">,</span>  <span class="mi">891339</span><span class="p">,</span>  <span class="mi">892581</span><span class="p">,</span>  <span class="mi">897917</span><span class="p">,</span>  <span class="mi">900497</span><span class="p">,</span>  <span class="mi">902791</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">907839</span><span class="p">,</span>  <span class="mi">908069</span><span class="p">,</span>  <span class="mi">910733</span><span class="p">,</span>  <span class="mi">936747</span><span class="p">,</span>  <span class="mi">945849</span><span class="p">,</span>  <span class="mi">952533</span><span class="p">,</span>  <span class="mi">965837</span><span class="p">,</span>  <span class="mi">967739</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1007573</span><span class="p">,</span> <span class="mi">1018197</span><span class="p">,</span> <span class="mi">1022845</span><span class="p">,</span> <span class="mi">1027277</span><span class="p">,</span> <span class="mi">1027963</span><span class="p">,</span> <span class="mi">1044711</span><span class="p">,</span> <span class="mi">1050091</span><span class="p">,</span> <span class="mi">1050839</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1053395</span><span class="p">,</span> <span class="mi">1060643</span><span class="p">,</span> <span class="mi">1070551</span><span class="p">,</span> <span class="mi">1080385</span><span class="p">,</span> <span class="mi">1087593</span><span class="p">,</span> <span class="mi">1095565</span><span class="p">,</span> <span class="mi">1111439</span><span class="p">,</span> <span class="mi">1141847</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1146745</span><span class="p">,</span> <span class="mi">1168487</span><span class="p">,</span> <span class="mi">1176229</span><span class="p">,</span> <span class="mi">1180219</span><span class="p">,</span> <span class="mi">1187279</span><span class="p">,</span> <span class="mi">1203567</span><span class="p">,</span> <span class="mi">1204739</span><span class="p">,</span> <span class="mi">1207205</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1212905</span><span class="p">,</span> <span class="mi">1233043</span><span class="p">,</span> <span class="mi">1252625</span><span class="p">,</span> <span class="mi">1256889</span><span class="p">,</span> <span class="mi">1272399</span><span class="p">,</span> <span class="mi">1298475</span><span class="p">,</span> <span class="mi">1302085</span><span class="p">,</span> <span class="mi">1305033</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1309991</span><span class="p">,</span> <span class="mi">1325833</span><span class="p">,</span> <span class="mi">1334399</span><span class="p">,</span> <span class="mi">1340793</span><span class="p">,</span> <span class="mi">1355737</span><span class="p">,</span> <span class="mi">1365593</span><span class="p">,</span> <span class="mi">1376389</span><span class="p">,</span> <span class="mi">1381963</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1390677</span><span class="p">,</span> <span class="mi">1405539</span><span class="p">,</span> <span class="mi">1421269</span><span class="p">,</span> <span class="mi">1426487</span><span class="p">,</span> <span class="mi">1433469</span><span class="p">,</span> <span class="mi">1448275</span><span class="p">,</span> <span class="mi">1458545</span><span class="p">,</span> <span class="mi">1462879</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1464553</span><span class="p">,</span> <span class="mi">1482773</span><span class="p">,</span> <span class="mi">1486655</span><span class="p">,</span> <span class="mi">1504839</span><span class="p">,</span> <span class="mi">1512277</span><span class="p">,</span> <span class="mi">1517895</span><span class="p">,</span> <span class="mi">1526807</span><span class="p">,</span> <span class="mi">1532327</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1543995</span><span class="p">,</span> <span class="mi">1545351</span><span class="p">,</span> <span class="mi">1553127</span><span class="p">,</span> <span class="mi">1563397</span><span class="p">,</span> <span class="mi">1572205</span><span class="p">,</span> <span class="mi">1573891</span><span class="p">,</span> <span class="mi">1583443</span><span class="p">,</span> <span class="mi">1595567</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1603263</span><span class="p">,</span> <span class="mi">1609551</span><span class="p">,</span> <span class="mi">1631223</span><span class="p">,</span> <span class="mi">1633943</span><span class="p">,</span> <span class="mi">1650589</span><span class="p">,</span> <span class="mi">1677741</span><span class="p">,</span> <span class="mi">1681935</span><span class="p">,</span> <span class="mi">1696649</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1713355</span><span class="p">,</span> <span class="mi">1715365</span><span class="p">,</span> <span class="mi">1730819</span><span class="p">,</span> <span class="mi">1741045</span><span class="p">,</span> <span class="mi">1745279</span><span class="p">,</span> <span class="mi">1751007</span><span class="p">,</span> <span class="mi">1758715</span><span class="p">,</span> <span class="mi">1778157</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1779521</span><span class="p">,</span> <span class="mi">1785051</span><span class="p">,</span> <span class="mi">1789451</span><span class="p">,</span> <span class="mi">1789671</span><span class="p">,</span> <span class="mi">1790781</span><span class="p">,</span> <span class="mi">1791763</span><span class="p">,</span> <span class="mi">1812959</span><span class="p">,</span> <span class="mi">1823427</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1824907</span><span class="p">,</span> <span class="mi">1842549</span><span class="p">,</span> <span class="mi">1846559</span><span class="p">,</span> <span class="mi">1847019</span><span class="p">,</span> <span class="mi">1865431</span><span class="p">,</span> <span class="mi">1879215</span><span class="p">,</span> <span class="mi">1895455</span><span class="p">,</span> <span class="mi">1930981</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1932295</span><span class="p">,</span> <span class="mi">1940509</span><span class="p">,</span> <span class="mi">1957911</span><span class="p">,</span> <span class="mi">1976957</span><span class="p">,</span> <span class="mi">1986973</span><span class="p">,</span> <span class="mi">1992813</span><span class="p">,</span> <span class="mi">1993333</span><span class="p">,</span> <span class="mi">1994939</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># We should be able to find all composite numbers smaller than 65536 with</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># this sieve. Well, we don&#39;t do Miller-Rabin for every numbers; or it will</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># be too time-consuming.</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">n</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Although I don&#39;t know why they used 256 (instead of 65536) here, I will</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># just stick to that.</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Now we use Miller-Rabin for the large numbers.</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">miller_rabin</span><span class="p">(</span><span class="n">bases</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span></code></pre></div><p>Trong bài này, ta được yêu cầu phải tính $log_g(h) \mod p$ 256 lần liên tiếp. Ta được phép nhập số $q$ sao cho <code>q.bit_length() = 512</code>, <code>is_prime(q)</code> và <code>is_prime(4*q - 1)</code></p>
<p>Trong lúc giải đang diễn ra thì mình không giải được câu này :((. Với việc tác giả có nhắc đến một challenge trong <code>UIUCTF 2022</code> nên mình đã làm theo và bị mắc kẹt trong suốt giải</p>
<p>Sau giải, mình mới để ý dòng này ở trong file <code>mathy.py</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Although I don&#39;t know why they used 256 (instead of 65536) here, I will</span>
</span></span><span class="line"><span class="cl"><span class="c1"># just stick to that.</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span></code></pre></div><p>và:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Yeah, come send me a large-enough prime q!</span>
</span></span><span class="line"><span class="cl"><span class="n">q</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;[&lt;] q = &#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Told you I need a large-enough prime.</span>
</span></span><span class="line"><span class="cl"><span class="k">assert</span> <span class="n">q</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">==</span> <span class="mi">512</span> <span class="ow">and</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</span></span></code></pre></div><p>trong file <code>chall.py</code></p>
<p>Ta có thể bypass hàm <code>is_prime()</code> bằng cách chọn ra số <strong>nguyên</strong> <code>x &lt; 256</code>. Server không hề check xem số ta gửi có phải là một số âm không, vì thế ta hoàn toàn có thể chọn một số âm $p = 1 \mod 4$ và hàm <code>is_prime()</code> sẽ luôn trả về True. Từ đó, ta có thể tính $q = (p - 1)/4$</p>
<p>Để tính dlog cho đơn giản, ta nên chọn $p$ sao cho $p - 1$ có thể phân tích thành các số nguyên tố nhỏ hơn, và hàm <code>.log()</code> trong sage sẽ tính được <code>x</code> rất nhanh</p>
<p>Vì mình không làm được trong giải, với lại vừa xong giải thì tác giả gửi writeup luôn nên chắc là mình sẽ lấy <a href="https://github.com/blackb6a/blackb6a-ctf-2023-challenges/blob/main/01-how-to-stop-time/src/solve.sage">code của tác giả</a> vậy:D</p>
<p>Trong code, tác giả cũng có giải thích cách tìm $p$ nên nếu không hiểu các bạn có thể đọc qua</p>
<p><code>solve.sage</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">trange</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># context.log_level = &#39;debug&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># r = process([&#39;python3&#39;, &#39;chall.py&#39;])</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">28101</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">trange</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;=== Round </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">/256 ===&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="mi">97523</span><span class="o">^</span><span class="mi">31</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;[&lt;] q = &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;[&gt;] g = &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;[&gt;] h = &#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># Note: p is not a prime!</span>
</span></span><span class="line"><span class="cl">    <span class="n">Zp</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">Zp</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;order(g) = </span><span class="si">{</span><span class="n">g</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;2**512   = </span><span class="si">{</span><span class="mi">2</span><span class="o">**</span><span class="mi">512</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">g</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">h</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span> <span class="si">= }</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;[&lt;] x = &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><blockquote>
<p>flag: b6actf{h0w_c4n_y0u_c0mpu73_d109s_s00ooo_qu1ckly}</p>
</blockquote>

    
  </article>

  <button onclick="topFunction()" id="back-to-top" title="Go to top">Back to Top</button>

  

<div id="sharingbuttons">
    
    
    <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Bauhinia%20CTF%202023&amp;url=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5 0-4.55 2.04-4.55 4.54 0 .36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3 0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35 0 12.92-6.92 12.92-12.93 0-.2 0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="mailto:?subject=Bauhinia%20CTF%202023&amp;body=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f" target="_self" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9 0 6v12c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17 0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1 0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08 0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://www.linkedin.com/sharing/share-offsite/?url=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6 0 2.5 1 2.6 2.5 0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f&amp;resubmit=true&amp;title=Bauhinia%20CTF%202023" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96 0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65 0 3-1.35 3-3s-1.35-3-3-3c-1.38 0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65 0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66 0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64 0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4 0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6 0 .23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1 0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="whatsapp://send?text=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.1 3.9C17.9 1.7 15 .5 12 .5 5.8.5.7 5.6.7 11.9c0 2 .5 3.9 1.5 5.6L.6 23.4l6-1.6c1.6.9 3.5 1.3 5.4 1.3 6.3 0 11.4-5.1 11.4-11.4-.1-2.8-1.2-5.7-3.3-7.8zM12 21.4c-1.7 0-3.3-.5-4.8-1.3l-.4-.2-3.5 1 1-3.4L4 17c-1-1.5-1.4-3.2-1.4-5.1 0-5.2 4.2-9.4 9.4-9.4 2.5 0 4.9 1 6.7 2.8 1.8 1.8 2.8 4.2 2.8 6.7-.1 5.2-4.3 9.4-9.5 9.4zm5.1-7.1c-.3-.1-1.7-.9-1.9-1-.3-.1-.5-.1-.7.1-.2.3-.8 1-.9 1.1-.2.2-.3.2-.6.1s-1.2-.5-2.3-1.4c-.9-.8-1.4-1.7-1.6-2-.2-.3 0-.5.1-.6s.3-.3.4-.5c.2-.1.3-.3.4-.5.1-.2 0-.4 0-.5C10 9 9.3 7.6 9 7c-.1-.4-.4-.3-.5-.3h-.6s-.4.1-.7.3c-.3.3-1 1-1 2.4s1 2.8 1.1 3c.1.2 2 3.1 4.9 4.3.7.3 1.2.5 1.6.6.7.2 1.3.2 1.8.1.6-.1 1.7-.7 1.9-1.3.2-.7.2-1.2.2-1.3-.1-.3-.3-.4-.6-.5z"/></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f&amp;t=Bauhinia%20CTF%202023" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    	<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 140"><path fill-rule="evenodd" d="M60.94 82.314L17 0h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L103.49 0h18.69L77.84 83.308v53.087h-16.9v-54.08z"></path></svg>
        </div>
      </div>
    </a>
    

    
    
    <a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Bauhinia%20CTF%202023&amp;url=http%3a%2f%2flocalhost%3a40099%2fposts%2fbauhinia-ctf-2023%2f" target="_blank" rel="noopener" aria-label="">
      <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.707 8.475C.275 8.64 0 9.508 0 9.508s.284.867.718 1.03l5.09 1.897 1.986 6.38a1.102 1.102 0 0 0 1.75.527l2.96-2.41a.405.405 0 0 1 .494-.013l5.34 3.87a1.1 1.1 0 0 0 1.046.135 1.1 1.1 0 0 0 .682-.803l3.91-18.795A1.102 1.102 0 0 0 22.5.075L.706 8.475z"/></svg>
        </div>
      </div>
    </a>
    
</div>
  <div class="paginator">
    
    <a class="link" href="http://localhost:40099/posts/writeup-minictf-22_7_2022/" title="MiniCTF 22/7">← prev</a>
    
    
    <a class="link" href="http://localhost:40099/posts/isogeny-based-cryptography/" title="Isogeny-Based Cryptography">next →</a>
    
  </div>
  <div class="comment">
    
    
    
    <script src="https://giscus.app/client.js"
    data-repo="michaelneuper/hugo-texify3"
    data-repo-id="R_kgDOIjPNaQ"
    data-category="General"
    data-category-id="DIC_kwDOIjPNac4CaklA"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme=""
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
</script>

  </div>
  
  
</main>

    <footer id="footer">
  <div>
    <span>Powered by  <a class=link href=https://gohugo.io target=_blank rel=noopener>Hugo</a> | 
Theme <a class=link href=https://github.com/michaelneuper/hugo-texify3 target=_blank rel=noopener>TeXify3</a>
</span>
  </div>
  <div>
    <span>Copyright © 2024 Michael Neuper</span>
  </div>
</footer>

  </div>

  
  <script src='http://localhost:40099/js/script.js' defer></script>

  
  

  
  

  
  

</body>

</html>
